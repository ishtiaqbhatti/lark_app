import{r as _,X as g,l as k,aj as r,aD as h,au as f,aE as j,ah as y,aA as v,aB as m,aC as w,Z as I,ak as L,as as x}from"./index-igZMX4Bp.js";import{b as R,c as b}from"./discoveryService-DfkK-Cg1.js";import{F as D}from"./Table-CAAunq6x.js";import{D as u}from"./index-Bk_6gEb-.js";import"./Pagination-ZF9HoXKE.js";var S={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},C=function(a,c){return _.createElement(g,k({},a,{ref:c,icon:S}))},O=_.forwardRef(C);const A=({opportunities:d,isLoading:a})=>{const c=[{title:"Keyword",dataIndex:"keyword",key:"keyword",render:(t,e)=>r.jsx(h,{to:`/opportunities/${e.id}`,children:t})},{title:"Search Volume",dataIndex:"search_volume",key:"search_volume",render:(t,e)=>{var o,s;return e.search_volume??((s=(o=e.full_data)==null?void 0:o.keyword_info)==null?void 0:s.search_volume)},sorter:(t,e)=>{var o,s,n,i;return(t.search_volume??((s=(o=t.full_data)==null?void 0:o.keyword_info)==null?void 0:s.search_volume))-(e.search_volume??((i=(n=e.full_data)==null?void 0:n.keyword_info)==null?void 0:i.search_volume))}},{title:"Keyword Difficulty",dataIndex:"keyword_difficulty",key:"keyword_difficulty",render:(t,e)=>{var o,s;return e.keyword_difficulty??((s=(o=e.full_data)==null?void 0:o.keyword_properties)==null?void 0:s.keyword_difficulty)},sorter:(t,e)=>{var o,s,n,i;return(t.keyword_difficulty??((s=(o=t.full_data)==null?void 0:o.keyword_properties)==null?void 0:s.keyword_difficulty))-(e.keyword_difficulty??((i=(n=e.full_data)==null?void 0:n.keyword_properties)==null?void 0:i.keyword_difficulty))}},{title:"CPC",dataIndex:"cpc",key:"cpc",render:(t,e)=>{var o,s;return e.cpc??((s=(o=e.full_data)==null?void 0:o.keyword_info)==null?void 0:s.cpc)},sorter:(t,e)=>{var o,s,n,i;return(t.cpc??((s=(o=t.full_data)==null?void 0:o.keyword_info)==null?void 0:s.cpc))-(e.cpc??((i=(n=e.full_data)==null?void 0:n.keyword_info)==null?void 0:i.cpc))}},{title:"Status",dataIndex:"status",key:"status",render:t=>{let e="geekblue";return t==="qualified"?e="green":t==="rejected"&&(e="volcano"),r.jsx(f,{color:e,children:t.toUpperCase()},t)}},{title:"Rejected Reason",dataIndex:"blog_qualification_reason",key:"blog_qualification_reason",render:(t,e)=>e.status==="rejected"?t:"-"}];return r.jsx(D,{columns:c,dataSource:d,loading:a,rowKey:"id"})},{Content:B}=w,{Title:T}=L,H=()=>{var i,p;const{runId:d}=j(),{data:a,isLoading:c,isError:t,error:e}=y(["discoveryRun",d],()=>b(d),{refetchInterval:l=>(l==null?void 0:l.status)==="running"?5e3:!1,refetchOnWindowFocus:!1}),{data:o,isLoading:s}=y(["discoveryRunOpportunities",d],()=>R(d),{enabled:!!a&&a.status==="completed"});if(c)return r.jsx(v,{tip:"Loading run details...",style:{display:"block",marginTop:"50px"}});if(t)return r.jsx(m,{message:"Error",description:e.message,type:"error",showIcon:!0});const n=l=>{switch(l){case"completed":return r.jsx(f,{color:"success",children:"Completed"});case"failed":return r.jsx(f,{color:"error",children:"Failed"});case"running":return r.jsx(f,{color:"processing",children:"In Progress"});default:return r.jsx(f,{children:l})}};return r.jsx(w,{style:{padding:"24px"},children:r.jsxs(B,{children:[r.jsx(I,{type:"link",icon:r.jsx(O,{}),style:{marginBottom:"16px",paddingLeft:0},children:r.jsx(h,{to:"/discovery",children:"Back to Discovery Hub"})}),r.jsx(T,{level:2,children:"Discovery Run Details"}),r.jsx(x,{style:{marginBottom:"24px"},children:r.jsxs(u,{title:"Run Summary",bordered:!0,children:[r.jsx(u.Item,{label:"Run ID",children:a.id}),r.jsx(u.Item,{label:"Status",children:n(a.status)}),r.jsx(u.Item,{label:"Seed Keyword",children:(p=(i=a.parameters)==null?void 0:i.seed_keywords)==null?void 0:p.join(", ")}),r.jsx(u.Item,{label:"Created At",children:new Date(a.start_time).toLocaleString()})]})}),a.status==="completed"&&r.jsx(x,{title:"Discovered Opportunities",children:r.jsx(A,{opportunities:o,isLoading:s})}),a.status==="failed"&&r.jsx(m,{message:"Run Failed",description:a.error_message||"An unknown error occurred.",type:"error",showIcon:!0})]})})};export{H as default};
