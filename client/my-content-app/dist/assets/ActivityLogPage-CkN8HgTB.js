import{af as x,ag as f,ah as y,aj as t,aA as h,aB as j,aC as o,ak as b,ao as r,aI as I,Z as k,ax as A}from"./index-igZMX4Bp.js";import{u as C}from"./useMutation-Bs8GWcgR.js";import{d as J,g as S}from"./orchestratorService-C1VspGjv.js";import{J as _}from"./JobStatusIndicator-BYpq26Zc.js";import{F as N}from"./Table-CAAunq6x.js";import{f as T}from"./formatDistanceToNow-BvfWpWYf.js";import{f as v}from"./format-Dc2cUM71.js";import"./progress-nMxHyNiz.js";import"./CheckCircleOutlined-DkLkWzh1.js";import"./Pagination-ZF9HoXKE.js";import"./en-US-ZGrySqFg.js";const{Content:w}=o,{Title:L,Text:s}=b,U=()=>{const l=x(),{showNotification:i}=f(),{data:d=[],isLoading:c,isError:u,error:n}=y("allJobs",S,{refetchInterval:e=>e!=null&&e.some(a=>a.status==="running"||a.status==="pending")?3e3:!1}),{mutate:p,isLoading:m}=C(e=>J(e),{onSuccess:()=>{i("info","Job Cancellation","Job cancellation request sent."),l.invalidateQueries("allJobs")},onError:e=>{i("error","Cancellation Failed",e.message||"An error occurred during cancellation.")}}),g=[{title:"Job ID",dataIndex:"id",key:"id",render:e=>t.jsxs(s,{code:!0,children:[e.substring(0,8),"..."]})},{title:"Type",dataIndex:"function_name",key:"function_name",render:e=>e?e.replace(/_background$/,"").replace(/_/g," ").replace("run ","").replace("run","").trim().toUpperCase():"N/A"},{title:"Status",dataIndex:"status",key:"status",render:(e,a)=>t.jsx(_,{jobId:a.id})},{title:"Current Step",dataIndex:"result",key:"step",render:e=>(e==null?void 0:e.step)||"N/A"},{title:"Started",dataIndex:"started_at",key:"started_at",render:e=>e?T(new Date(e*1e3),{addSuffix:!0}):"N/A"},{title:"Finished",dataIndex:"finished_at",key:"finished_at",render:e=>e?v(new Date(e*1e3),"MMM d, hh:mm a"):"N/A"},{title:"Error",dataIndex:"error",key:"error",render:e=>e?t.jsx(r,{title:e,children:t.jsx(s,{type:"danger",ellipsis:!0,children:e})}):"N/A"},{title:"Actions",key:"actions",render:(e,a)=>t.jsx(I,{size:"small",children:a.status==="running"&&t.jsx(r,{title:"Cancel Job",children:t.jsx(k,{danger:!0,icon:t.jsx(A,{}),size:"small",onClick:()=>p(a.id),loading:m})})})}];return c?t.jsx(h,{tip:"Loading activity log...",style:{display:"block",marginTop:"50px"}}):u?t.jsx(j,{message:"Error",description:(n==null?void 0:n.message)||"Failed to load activity log. Please try again.",type:"error",showIcon:!0}):t.jsx(o,{style:{padding:"24px"},children:t.jsxs(w,{children:[t.jsx(L,{level:2,children:"Activity Log"}),t.jsx(N,{columns:g,dataSource:d,rowKey:"id",pagination:{pageSize:10},scroll:{x:1e3}})]})})};export{U as default};
